<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>AI Smart Patient Triage Dashboard</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<style>

/* ===== GLOBAL ===== */
body{
    margin:0;
    font-family:'Segoe UI', Arial, sans-serif;
    background:
      radial-gradient(circle at top right,#312e8140 0%, transparent 40%),
      radial-gradient(circle at bottom left,#7c3aed22 0%, transparent 45%),
      #050917;
    color:#e5e7eb;
}

h1{
    font-size:32px;
    font-weight:700;
    color:#8b5cf6;
    margin:0 0 4px;
}

.subtitle{
    color:#94a3b8;
    font-size:14px;
    margin-bottom:20px;
}

/* ===== MAIN PANEL (LIKE REFERENCE IMAGE) ===== */
.container{
    width:95%;
    max-width:1300px;
    margin:auto;
    padding:24px;
    background:rgba(17,26,51,0.75);
    border:1px solid rgba(99,102,241,0.25);
    border-radius:20px;
    box-shadow:0 0 30px rgba(99,102,241,0.2);
}

/* ===== CARDS ===== */
.card{
    background:rgba(15,23,42,0.85);
    border:1px solid rgba(99,102,241,0.25);
    border-radius:16px;
    padding:18px;
    box-shadow:0 0 20px rgba(99,102,241,0.10);
}

/* ===== INPUTS ===== */
input,select{
    width:100%;
    padding:10px;
    margin:5px 0 12px;
    border-radius:10px;
    border:1px solid #2d3b55;
    background:#080f22;
    color:#e2e8f0;
    outline:none;
}

input:focus,select:focus{
    border-color:#7c3aed;
    box-shadow:0 0 10px rgba(124,58,237,0.45);
}

/* ===== BUTTON ===== */
button{
    width:100%;
    background:linear-gradient(90deg,#4f46e5,#8b5cf6);
    color:white;
    border:none;
    padding:12px 20px;
    border-radius:30px;
    font-weight:bold;
    letter-spacing:0.5px;
    cursor:pointer;
    box-shadow:0 0 20px rgba(139,92,246,0.45);
}

button:hover{
    opacity:0.92;
}

/* ===== RISK COLORS ===== */
.high{color:#ef4444;font-weight:bold;}
.medium{color:#f59e0b;font-weight:bold;}
.low{color:#22c55e;font-weight:bold;}

.error{color:#f87171;font-weight:bold;}

/* ===== SUMMARY ===== */
.summary-grid{
    display:grid;
    grid-template-columns:repeat(4,1fr);
    gap:12px;
    margin-bottom:20px;
}

.summary-box{
    background:rgba(15,23,42,0.85);
    border:1px solid rgba(99,102,241,0.2);
    padding:12px;
    border-radius:12px;
    text-align:center;
}

/* ===== LAYOUT ===== */
.main-grid{
    display:grid;
    grid-template-columns:2fr 1fr;
    gap:20px;
    margin-top:15px;
}

/* ===== MASTER CONTAINER ===== */
.dashboard{
    width:95%;
    max-width:1350px;
    margin:20px auto;
    padding:20px;
    background:rgba(17,26,51,0.75);
    border:1px solid rgba(99,102,241,0.25);
    border-radius:20px;
    box-shadow:0 0 30px rgba(99,102,241,0.2);
}

/* HEADER */
.header{
    margin-bottom:22px;
    padding-left:4px;
}


/* TOP 3-COLUMN GRID */
.top-grid{
    display:grid;
    grid-template-columns: 1fr 1fr 0.9fr;
    gap:16px;
}

/* INPUT CARD SCROLL IF SMALL SCREEN */
.input-card{
    max-height:640px;
    overflow:auto;
}

/* TABLE CARD */
.table-card{
    margin-top:16px;
}

/* TABLE */
table{
    width:100%;
    border-collapse:collapse;
}

th{
    text-align:left;
    padding:10px;
    background:#1f2a4a;
}

td{
    padding:10px;
    border-bottom:1px solid #273449;
}
/* extra premium glow */
.risk-card{
    box-shadow:0 0 30px rgba(139,92,246,0.35);
}

.analysis-card{
    box-shadow:0 0 20px rgba(99,102,241,0.25);
}

/* ===== FORCE PRO LAYOUT ===== */
.top-grid{
    display:grid;
    grid-template-columns: 1.05fr 1.1fr 0.9fr;
    gap:18px;
    align-items:stretch;
}

.card{
    min-height:430px;
}

.analysis-card{
    min-height:430px;
}

.risk-card{
    min-height:430px;
}

.risk-badge{
    display:inline-block;
    padding:8px 16px;
    border-radius:10px;
    font-weight:700;
    background:linear-gradient(90deg,#f59e0b,#fbbf24);
    color:#111;
    margin-bottom:10px;
}


</style>

</head>

<body>
<div class="dashboard">

    <!-- HEADER -->
    <div class="header">
        <h1>Smart Patient Triage Dashboard</h1>
        <p class="subtitle">
            AI-powered real-time patient triage and risk prioritization
        </p>
    </div>

    <!-- TOP GRID -->
    <div class="top-grid">

        <!-- LEFT: INPUT -->
        <div class="card input-card">
            <h3>Patient Data</h3>

            Patient Name
            <input id="name" type="text" placeholder="John Doe">

            Patient ID
            <input id="pid" type="text" placeholder="P001">

            Age
            <input id="age" type="number">

            Weight (kg)
            <input id="weight" type="number">

            Gender
            <select id="gender">
                <option>Male</option>
                <option>Female</option>
                <option>Other</option>
            </select>

            Symptoms
            <input id="symptom" type="text" placeholder="fever, chest pain">

            Temperature (°F)
            <input id="temp" type="number">

            Heart Rate
            <input id="hr" type="number">

            Pre-existing Condition
            <select id="condition">
                <option>None</option>
                <option>Diabetes</option>
                <option>Heart Disease</option>
            </select>

            EHR / EMR Upload
            <input id="ehrFile" type="file" accept=".pdf,.txt,.csv,.jpg,.jpeg,.png" onchange="processEHR()">

            <p id="ehrStatus"></p>

            <button onclick="analyze()">ANALYZE</button>
            <p id="error" class="error"></p>
        </div>

        <!-- MIDDLE: LIVE ANALYSIS -->
        <div class="card analysis-card">
            <h3>Live Analysis</h3>
            <p id="risk"></p>
            <p id="dept"></p>
            <p id="explain"></p>
            <p id="confidence"></p>
            <p id="summary"></p>
        </div>

        <!-- RIGHT: HIGHLIGHT CARD -->
        <!-- RIGHT: DEPARTMENT CHART -->
<div class="card risk-card">
    <h3>Department Load (Live)</h3>

    <canvas id="deptChart" height="260"></canvas>
</div>


    </div>

    <!-- TABLE -->
    <div class="card table-card">
        <h3>Triaged Patient Queue</h3>
        <table>
            <thead>
                <tr>
                    <th>Name</th>
                    <th>ID</th>
                    <th>Age</th>
                    <th>Risk</th>
                    <th>Department</th>
                    <th>Confidence</th>
                </tr>
            </thead>
            <tbody id="patientTable"></tbody>
        </table>
    </div>

</div>


<script>

let patients = [];
let deptChart = null;

/* =========================
   EHR FILE HANDLING
========================= */
function processEHR(){
    let file = document.getElementById("ehrFile").files[0];

    if(file){
        document.getElementById("ehrStatus").innerText =
        "✅ EHR / EMR document processed: " + file.name;

        document.getElementById("symptom").value =
        "Imported from EHR document";
    }
}

/* =========================
   MAIN ANALYSIS
========================= */
function analyze(){

    document.getElementById("error").innerText = "";

    // INPUT VALUES
    let name = document.getElementById("name").value.trim();
    let pid = document.getElementById("pid").value || "Unknown";
    let age = parseInt(document.getElementById("age").value);
    let weight = parseFloat(document.getElementById("weight").value);
    let temp = parseFloat(document.getElementById("temp").value);
    let hr = parseInt(document.getElementById("hr").value);
    let symptom = document.getElementById("symptom").value.toLowerCase();
    let condition = document.getElementById("condition").value;

    // VALIDATION
    if(name===""){
        document.getElementById("error").innerText="Please enter patient name.";
        return;
    }

    if(isNaN(age)||isNaN(weight)||isNaN(temp)||isNaN(hr)){
        document.getElementById("error").innerText="Fill all medical fields.";
        return;
    }

    // AI LOGIC
    let risk="", dept="", confidence="", reasons=[];

    if(temp>102 || hr>120 || symptom.includes("breathing")){
        risk="HIGH";
        dept="Emergency";
        confidence="92%";
        reasons.push("Critical vitals or emergency symptoms");
    }
    else if(
        (age>60 && condition!="None") ||
        condition=="Heart Disease" ||
        symptom.includes("chest")
    ){
        risk="MEDIUM";
        dept="Cardiology";
        confidence="84%";
        reasons.push("Cardiac history or moderate risk factors");
    }
    else{
        risk="LOW";
        dept="General Medicine";
        confidence="78%";
        reasons.push("Stable vitals");
    }

    if(weight>110 && risk==="LOW"){
        risk="MEDIUM";
        reasons.push("High weight factor");
    }

    if(symptom.includes("head")) dept="Neurology";

    // DISPLAY LIVE ANALYSIS
    document.getElementById("risk").innerHTML =
        "Risk Level: <span class='"+risk.toLowerCase()+"'>"+risk+"</span>";

    document.getElementById("dept").innerText =
        "Recommended Department: " + dept;

    document.getElementById("explain").innerText =
        "Explainability: " + reasons.join(", ");

    document.getElementById("confidence").innerText =
        "Confidence Score: " + confidence;

    document.getElementById("summary").innerText =
        name + " is classified as " + risk +
        " risk and should be routed to " + dept + ".";

    // ADD PATIENT
    patients.push({name,pid,age,risk,dept,confidence});

    // SORT BY PRIORITY
    patients.sort((a,b)=>riskPriority(a.risk)-riskPriority(b.risk));

    // UPDATE UI
    updateTable();
    updateDeptChart();
}

/* =========================
   RISK PRIORITY
========================= */
function riskPriority(r){
    if(r==="HIGH") return 1;
    if(r==="MEDIUM") return 2;
    return 3;
}

/* =========================
   UPDATE TABLE
========================= */
function updateTable(){
    let table=document.getElementById("patientTable");
    table.innerHTML="";

    patients.forEach(p=>{
        table.innerHTML += `
        <tr>
            <td>${p.name}</td>
            <td>${p.pid}</td>
            <td>${p.age}</td>
            <td class="${p.risk.toLowerCase()}">${p.risk}</td>
            <td>${p.dept}</td>
            <td>${p.confidence}</td>
        </tr>`;
    });
}

/* =========================
   DEPARTMENT CHART
========================= */
function updateDeptChart(){

    const departments = [
        "Neurology",
        "Gynaecology",
        "Cardiology",
        "Emergency",
        "General Medicine"
    ];

    let high=[0,0,0,0,0];
    let med=[0,0,0,0,0];
    let low=[0,0,0,0,0];

    patients.forEach(p=>{
        let i = departments.indexOf(p.dept);
        if(i===-1) return;

        if(p.risk==="HIGH") high[i]++;
        else if(p.risk==="MEDIUM") med[i]++;
        else low[i]++;
    });

    if(deptChart) deptChart.destroy();

    const ctx=document.getElementById("deptChart");

    deptChart = new Chart(ctx,{
        type:"bar",
        data:{
            labels:departments,
            datasets:[
                {label:"High", data:high, backgroundColor:"#ef4444"},
                {label:"Medium", data:med, backgroundColor:"#f59e0b"},
                {label:"Low", data:low, backgroundColor:"#22c55e"}
            ]
        },
        options:{
            responsive:true,
            plugins:{
                legend:{labels:{color:"#cbd5e1"}}
            },
            scales:{
                x:{ticks:{color:"#cbd5e1"}},
                y:{beginAtZero:true,ticks:{color:"#cbd5e1"}}
            }
        }
    });
}

</script>


</body>
</html>
